(function(a){a.fn.extend({lyTimer:function(h){var e=a(this),k=e[0],g=e.offset();if("INPUT"==k.nodeName){var f=a.extend({startTime:"08:00",endTime:"23:30",step:30,startLimit:"",endLimit:"",default:"08:00"},h),l=function(){for(var a="",b=f.startTime;b<f.endTime;){b==f.default?(a+='<li class="active">'+b+"</li>",e.val(b).data("value",b)):a+="<li>"+b+"</li>";var c=b.split(":"),b=parseInt(c[0]),c=parseInt(c[1])+f.step;59<c&&(b+=1,c-=60);b=(10>b?"0"+b:b)+":"+(10>c?"0"+c:c)}return a},m=function(d){var b= "#"+a(this).data("id");a(".lyTimer").hide();if(f.startLimit){var c=a(f.startLimit).val();a(b).children().each(function(){a(this).html()<c?a(this).addClass("enable"):a(this).removeClass("enable")})}if(f.endLimit){var e=a(f.endLimit).val();a(b).children().each(function(){a(this).html()>e?a(this).addClass("enable"):a(this).removeClass("enable")})}a(b).show();d.stopPropagation()},n=function(a){if(48>a.keyCode||58<a.keyCode)return!1},p=function(){var d=/^\d{4}$/,b=a(this).val();/^\d{2}\:\d{2}$/.test(b)? a(this).data("value",b):d.test(b)?(d=b.substring(0,2),d+=":"+b.substring(2,4),a(this).val(d).data("value",d)):a(this).val(a(this).data("value"))};(function(){if(!e.data("hasAdd")){var d="lyTimer_"+a(".lyTimer").length,b=a('<ul class="lyTimer" id="'+d+'" style="top:'+(g.top+e.outerHeight())+"px;left:"+g.left+'px"></ul>');b.append(l());a("body").append(b).click(function(){b.hide()});e.addClass("has_add_ly").data({hasAdd:!0,id:d}).click(m).keypress(n).change(p);b.find("li").click(function(c){c.stopPropagation();a(this).hasClass("enable")||(a(this).addClass("active").siblings().removeClass(),e.val(a(this).html()),b.hide())})}})();return e}}})})(jQuery);